<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ko">
    <head>
        <title>통나무 펜션</title>
        <!-- jQuery -->
        <script src="/js/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
        
        <!-- jQuery datepicker ;부트스트랩이랑 겹치는 게 없다 -->
        <script src="/js/jquery-ui.js"></script>
        <link rel="stylesheet" href="/css/jquery-ui.css">
        
        <!-- Bootstrap -->
        <link rel="stylesheet" href="/css/bootstrap.min.css" integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
        <script src="/js/bootstrap.bundle.min.js" integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct" crossorigin="anonymous"></script>

        <link rel="stylesheet" href="/booking/booking_style.css">
    </head>
    <body>
        <div id="wrap" class="container px-5 pb-4">
            <header th:fragment="headerHomeBooking" class="h-100">
                <div class="d-flex">
                    <span class="display-4 mx-auto my-3">통나무 펜션</span>
                </div>
                <nav class="menu">
                    <ul class="nav justify-content-around w-100">
                        <li class="nav-item col-3 mx-auto">
                            <a class="nav-link text-center" href="#">팬션소개</a>
                        </li>
                        <li class="nav-item col-3">
                            <a class="nav-link text-center" href="#">객실보기</a>
                        </li>
                        <li class="nav-item col-3">
                            <a class="nav-link text-center" href="#">예약하기</a>
                        </li>
                        <li class="nav-item col-3">
                            <a class="nav-link text-center" href="/booking/booking-list-view">예약목록</a>
                        </li>
                    </ul>
                </nav>
            </header>
            <section class="contents">
                <div class="banner_main">
                    <img id="banner" class="w-100 h-100" src="/img/test06_banner1.jpg">
                </div>
                <section class="downside w-100 d-flex">
                    <div class="side-left col-4 text-white d-flex justify-content-center">
                        <p class="my-auto">실시간<br> 예약하기</p>
                    </div>
                    <div class="verify-rsv col-4 px-0 pt-2 d-flex flex-column justify-content-around align-content-end">
                        <div class="d-flex text-white py-2 px-2 justify-content-between">
                            <span class="ml-3 text-center">
                            	<h4 class="m-0">
                            		예약 확인
                           		</h4>
                        	</span>
                            <div class="input-radio__isMember px-2 my-auto">
                                <label class="my-auto px-2">
                                	회원
                                	<input id="isMember" type="radio" name="membership" value="member" checked>
                               	</label>
                                <label class="my-auto ">
                                	비회원
                                	<input id="isNon-member" type="radio" name="membership" value="non-members">
                               	</label>
                            </div>
                        </div>
                        <div class="member-verify-reservation flex-column justify-content-around mr-3">
                            <div class="section_id d-flex justify-content-end">
                                <span class="name_input text-white col-4 my-auto px-2">
                                	아이디
                               	</span>
                                <input id="text_id" class="form-control form-control-sm col-7" type="text">
                            </div>
                            <div class="section_ps d-flex justify-content-end pt-2">
                                <span class="name_input text-white col-4 my-auto px-2">
                                	비밀번호
                               	</span>
                                <input id="text_ps" class="form-control form-control-sm col-7" type="password">
                            </div>
                        </div>
                        <div class="non-member-verify-reservation flex-column justify-content-around mr-3">
                            <div class="section_name d-flex justify-content-end pt-1">
                                <span class="name_input text-white col-4 my-auto px-2">
                                	이름
                               	</span>
                                <input id="text_name" class="form-control form-control-sm col-7" type="text">
                            </div>
                            <div class="section_phone d-flex justify-content-end pt-1">
                                <span class="name_input text-white col-4 my-auto px-2">
                                	전화번호
                               	</span>
                                <input id="text_phone" class="form-control form-control-sm col-7" type="text">
                            </div>
                            <div class="section_datepicker d-flex justify-content-end pt-1">
                                <span class="name_input text-white col-4 my-auto px-2">
                                	날짜
                               	</span>
                                <input id="datepicker-reservation" class="form-control form-control-sm col-7" type="text">
                            </div>
                        </div>
                        <div class="d-flex justify-content-end pb-3">
                            <button type="submit" id="btn-check-resevation" class="btn btn-success py-0 mr-3 col-5">
                            	조회하기
                           	</button>
                        </div>
                    </div>
                    <div class="side-right col-4 d-flex justify-content-center">
                        <div class="text-white my-auto">
                            <h2 class="">예약문의:</h3>
                            <h2 class="">010 -<br>
                            0000 - 1111</h4>
                        </div>
                    </div>
                </section>
            </section>
            <footer class="px-4 pt-4">
                <adress>
                    <small class="text-secondary">
                        제주특별자치도 제주시 애월읍<br>
                        사업자등록번호:111-222-255222 / 농어촌민박사업자지정 / 대표: 서리태 <br>
                        Copyright 2024 tongnamu.All right reserved.
                    </small>
                </adress>
            </footer>
        </div>

        <!-- Javascript -->
        <script>
            $(document).ready(function(){

//라디오에 변경이 있었을 때
//2-1) 회원/비회원 선택 시 인풋 변경
                $("input[name=membership]").on('change',function(){ 

                    // let isMembership = $("input[name=membership]:checked").val() == "member" ;
                    let isMembership = $(this).val() == "member" ;
//$(this)는 생각보다 많은 뜻을 함축하고 있다!
    //this는 input들 중, name= membership인데, change가 일어난 게 딱 하나라서
    //그걸 this라고 말한다.
    //this는 후보가 여러개 있더라도 이벤트가 일어난 대상 하나를 지칭한다.
//굳이 checked로 표시된 내용값을 얻어올 필요 없이 바로 this라고 기재하면 끝!

                    $(".member-verify-reservation").css('display',isMembership ? 'flex' : 'none');
                    $(".non-member-verify-reservation").css('display',isMembership ? 'none' : 'flex');
                })

                $("#datepicker-reservation").datepicker({
                    changeMonth : true
                    , changeYear : true
                    , minDate: 0  //오늘 이후부터 선택 가능
                    , dayNamesMin: ['일', '월', '화', '수', '목', '금', '토']
                    , dateFormat: 'yy년 mm월 dd일'
                })

//선생님께선 버튼 2개로 생성하심
    //이 경우에는 id가 같을 수 없고, class가 일치하게 작성한다.

//3) 조회하기    
                $("#btn-check-resevation").on('click',function(){
                    let isMembership = $("input[name=membership]:checked").val() == "member"
                        //라디오 인풋 중 checked 된 것만 가져오기
                    if(isMembership){
                        //회원에 대한 Validation
//서로 안쪽에 있는 변수만 지정하는 것이 좋다.
    //if문 바깥쪽에 굳이 지정하면 메모리 낭비
                        let id = $("#text_id").val().trim();
                        let pw = $("#text_ps").val();
                        if(id == "" || pw == ""){
                            alert("올바른 아이디와 비밀번호를 입력해 주세요.");
                            return;
                        }
                        alert(id + "님, 환영합니다!")
                    } else {
                        //비회원에 대한 Validation
                        let name = $("#text_name").val().trim();
                        let phonenumber = $("#text_phone").val().trim();
                        let date = $("#datepicker-reservation").val();
                        if(name == ""){
                            alert("올바른 이름을 작성해 주세요")
                            return
                        }
                            //startsWith()라는 함수로 바로 "010"으로 시작하는지 체크해야
                        if(phonenumber.length < 0 || phonenumber.startsWith("010") == false){
                                //느낌표로 부정문을 체크해도 좋지만 가독성이 나빠서 잘 안씀
                            
                            alert("010으로 시작하는 올바른 번호만 입력 가능합니다")
                            return
                        }
                        let regex = /^(01[0-9]{1}-?[0-9]{4}-?[0-9]{4}|01[0-9]{8})$/
                        if(regex.test(phonenumber) == false){
                            alert("올바른 전화번호를 입력하여 주십시오.")
                            return
                        }

                        if(date == ""){
                            alert(date + "예약 날짜를 선택하여 주십시오.")
                            return
                        }
                        alert(name + "님, \n"
                            + date +"에 예약 확인하였습니다. \n"
                            + phonenumber +" 해당 번호가 아닐 경우, 연락주시길 바랍니다."
                        )
                    }
                })

                let images = ["/img/test06_banner1.jpg","/img/test06_banner2.jpg","/img/test06_banner3.jpg","/img/test06_banner4.jpg"]
//확장자까지 적어줘야                
                let count = 0

//자동으로 특정 시간 이후 반복 행동을 하는 함수, setInterval()
    //setInterval함수는 parameter로 함수명(또는 람다함수;익명함수)와 밀리세컨드가 들어간다!
    
                /* setInterval(function(){ 
                        let idx_cur = count
                            //계속 순회하도록 하려면, 배열 변수가 바깥에 있어야 한다.
                        let idx_next = (count + 1) % images.length  //배열의 길이를  동적으로 바꾸겠다는 뜻
                        count = idx_next
                    
                        $('#banner').attr('src', images[idx_next])
                    }, 3000 ) */
            })
        </script>
    </body>
</html>